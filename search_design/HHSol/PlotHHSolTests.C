  rr -b -q '~/GitRepositories/TreeAnalyzer/search_design/tryNewHiggsSolver.C+("../../7_13_18_eleSF_andMuTrig/eleRecoFollowUp/testTree_1000.root",2,1,"tryNewHiggsSolver_rad_m1000.root")' &
  rr -b -q '~/GitRepositories/TreeAnalyzer/search_design/tryNewHiggsSolver.C+("../../7_13_18_eleSF_andMuTrig/eleRecoFollowUp/testTree_2000.root",2,1,"tryNewHiggsSolver_rad_m2000.root")' &
  rr -b -q '~/GitRepositories/TreeAnalyzer/search_design/tryNewHiggsSolver.C+("../../7_13_18_eleSF_andMuTrig/eleRecoFollowUp/testTree_4000.root",2,1,"tryNewHiggsSolver_rad_m4000.root")' &
  
      rr -b -q '~/GitRepositories/TreeAnalyzer/search_design/tryNewHiggsSolver.C+("skimTTbar.root",1,1,"tryNewHiggsSolver_ttbar.root")' &
  
  
  
  rr -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/eos/uscms/store/user/lpchh/HHWWbb_trees/8_6_18_complete/TTJets_SingleLeptFromT_TuneCUETP8M1_13TeV-madgraphMLM-pythia8/crab_tbar-t1l-madgraph-ext/180807_024616/0000/tbar-t1l-madgraph-ext_180.root",2,1,"skimTTbar.root")'
  
  
  
  /eos/uscms/store/user/lpchh/HHWWbb_trees/8_6_18_complete/QCD_HT1000to1500_TuneCUETP8M1_13TeV-madgraphMLM-pythia8/crab_qcd_ht1000to1500-ext/180807_031143/0000/qcd_ht1000to1500-ext_30.root
  
  
  
  
  
  
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_radion_hh_bbinc_m1000_0.txt",2,6,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_radion_hh_bbinc_m1000_0.root",1,199260)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_radion_hh_bbinc_m1400_0.txt",2,5,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_radion_hh_bbinc_m1400_0.root",1,195599)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_radion_hh_bbinc_m2000_0.txt",2,5,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_radion_hh_bbinc_m2000_0.root",1,199661)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_radion_hh_bbinc_m3000_0.txt",2,5,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_radion_hh_bbinc_m3000_0.root",1,193422)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_radion_hh_bbinc_m4000_0.txt",2,5,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_radion_hh_bbinc_m4000_0.root",1,197003)' &
  
  
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_0.txt",1,20,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_0.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_1.txt",1,40,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_1.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_2.txt",1,60,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_2.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_3.txt",1,80,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_3.root",182.18,60210394)' &
 
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_4.txt",1,100,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_4.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_5.txt",1,120,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_5.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_6.txt",1,140,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_6.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_7.txt",1,160,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_7.root",182.18,60210394)' &
  
  
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_8.txt",1,180,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_8.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_9.txt",1,200,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_9.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_10.txt",1,220,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_10.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_11.txt",1,240,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_11.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_12.txt",1,260,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_12.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_13.txt",1,280,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_13.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_14.txt",1,300,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_14.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_15.txt",1,320,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_15.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_16.txt",1,340,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_16.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_17.txt",1,360,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_17.root",182.18,60210394)' &
  root -l -b -q 'TreeAnalyzer/skims/baselineSkim.C+("/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/jobs/12_5_ttSkim/files_t-tbar1l-madgraph_18.txt",1,378,"/uscms_data/d3/nmccoll/2011-04-15-susyra2/rel_HbbWW/work/analyzer_running/out/out_t-tbar1l-madgraph_18.root",182.18,60210394)' &
  
  
  
  rr -b -q '~/GitRepositories/TreeAnalyzer/search_design/tryNewHiggsSolver.C+("skimtree_base_sigEMU/out_radion_hh_bbinc_m1000_0.root",2,1,"tryNewHiggsSolver_rad_m1000.root")' &
  rr -b -q '~/GitRepositories/TreeAnalyzer/search_design/tryNewHiggsSolver.C+("skimtree_base_sigEMU/out_radion_hh_bbinc_m1400_0.root",2,1,"tryNewHiggsSolver_rad_m1400.root")' &
  rr -b -q '~/GitRepositories/TreeAnalyzer/search_design/tryNewHiggsSolver.C+("skimtree_base_sigEMU/out_radion_hh_bbinc_m2000_0.root",2,1,"tryNewHiggsSolver_rad_m2000.root")' &
  rr -b -q '~/GitRepositories/TreeAnalyzer/search_design/tryNewHiggsSolver.C+("skimtree_base_sigEMU/out_radion_hh_bbinc_m3000_0.root",2,1,"tryNewHiggsSolver_rad_m3000.root")' &
  rr -b -q '~/GitRepositories/TreeAnalyzer/search_design/tryNewHiggsSolver.C+("skimtree_base_sigEMU/out_radion_hh_bbinc_m4000_0.root",2,1,"tryNewHiggsSolver_rad_m4000.root")' &
  rr -b -q '~/GitRepositories/TreeAnalyzer/search_design/tryNewHiggsSolver.C+("skimtree_base_sigEMU/out_qcd.root",1,1,"tryNewHiggsSolver_qcd.root")' &
  rr -b -q '~/GitRepositories/TreeAnalyzer/search_design/tryNewHiggsSolver.C+("skimtree_base_tau_hbbCSV/out_t-tbar1l-madgraph.root",1,1,"tryNewHiggsSolver_ttbar.root")' &
        
        
        rr -b -q '~/GitRepositories/TreeAnalyzer/background_estimation/predMacros/makeBETrees.C+("skimtree_base_sigEMU/out_radion_hh_bbinc_m1000_0.root",2,1,"betree_rad_m1000.root")' &
        rr -b -q '~/GitRepositories/TreeAnalyzer/background_estimation/predMacros/makeBETrees.C+("skimtree_base_sigEMU/out_radion_hh_bbinc_m1400_0.root",2,1,"betree_rad_m1400.root")' &
        rr -b -q '~/GitRepositories/TreeAnalyzer/background_estimation/predMacros/makeBETrees.C+("skimtree_base_sigEMU/out_radion_hh_bbinc_m2000_0.root",2,1,"betree_rad_m2000.root")' &
        rr -b -q '~/GitRepositories/TreeAnalyzer/background_estimation/predMacros/makeBETrees.C+("skimtree_base_sigEMU/out_radion_hh_bbinc_m3000_0.root",2,1,"betree_rad_m3000.root")' &
        rr -b -q '~/GitRepositories/TreeAnalyzer/background_estimation/predMacros/makeBETrees.C+("skimtree_base_sigEMU/out_radion_hh_bbinc_m4000_0.root",2,1,"betree_rad_m4000.root")' &
        rr -b -q '~/GitRepositories/TreeAnalyzer/background_estimation/predMacros/makeBETrees.C+("skimtree_base_sigEMU/out_qcd.root",1,1,"betree_qcd.root")' &
        rr -b -q '~/GitRepositories/TreeAnalyzer/background_estimation/predMacros/makeBETrees.C+("skimtree_base_tau_hbbCSV/out_t-tbar1l-madgraph.root",1,1,"betree_ttbar.root")' &
        
        
  
  hadd -f tryNewHiggsSolverAll.root tryNewHiggsSolver_*.root
  
  
  {
      TFile * f = new TFile("tryNewHiggsSolverAll.root","read");
      // std::vector<std::string> vars = {"metPerp","metPar","neutPar","neutParRelhwwMag","extraMetPar","extraMetPerp","extraMetParRelhwwMag","virtualSD_trueW","onshellSD_trueW"};
      // std::vector<std::string> vars = {"wqqPRes","wqqPTRes"};
      // std::vector<std::string> vars = {"oldSol_nzR","oldSol_nPTR","oldSol_nDPhi"};
            std::vector<std::string> vars = {"neutTheta","neutThetamOT","neutThetamlT","neutThetamAT"};
                  // std::vector<std::string> vars = {"virtualSD","onshellSD","virtualSD_trueW","onshellSD_trueW","virtualSD_trueH","onshellSD_trueH","virtualSD_totalM","onshellSD_totalM"};

      std::vector<std::string> samps = {"m1000","m1400","m2000","m3000","m4000"};
      
      for(unsigned int iV = 0; iV < vars.size(); ++iV){
          Plotter * p = new Plotter();
          for(unsigned int iS = 0; iS < samps.size(); ++iS){
          TH1 * h = 0;
          f->GetObject((samps[iS]+"_"+vars[iV]).c_str(),h);
          if(h==0) continue;
          p->addHistLine(h,samps[iS]);
                    
          }
          // p->rebin(5);
          
          p->normalize();
          p->draw(false,vars[iV]);
      }
  
  
  }
  
  
  {
      TFile * f = new TFile("tryNewHiggsSolverAll.root","read");
                  std::vector<std::string> vars = {"perfect_mass","orig_mass","new_mass"};
                  std::vector<std::string> samps = {"m1000","m1400","m2000","m3000","m4000"};
          for(unsigned int iS = 0; iS < samps.size(); ++iS){
          Plotter * p = new Plotter();

      for(unsigned int iV = 0; iV < vars.size(); ++iV){
          TH1 * h = 0;
          f->GetObject((samps[iS]+"_"+vars[iV]).c_str(),h);
          if(h==0) continue;
          // h = PlotTools::getIntegral(h,true,true);
          p->addHistLine(h,samps[iS] +"_"+ vars[iV]);

          }
          // p->rebin(5);
          p->normalize();
          p->setBotMinMax(0.,2.);
          p->drawSplitRatio(0,"stack",false,false,samps[iS]);
      }


  }
  
  
  
  {
      TFile * f = new TFile("tryNewHiggsSolverAll.root","read");
      // std::vector<std::string> vars = {"orig_hh_mass","new_hh_mass","newLowChisq_hh_mass","chisq","md","hWW_pt","lowchisq_md","lowmd_chisq"};
      // std::vector<std::string> vars = {"orig_hWW_eta","new_hWW_eta","newLowChisq_hWW_eta","sf"};
            // std::vector<std::string> vars = {"jetMass","jetSDMass","jetDM","jetSJDM"};
     
                  std::vector<std::string> vars = {"hhB_deltaPhi","hhB_deltaTheta","hhB_deltaPhi2","hhB_deltaTheta2","hh2TeV_hhB_deltaPhi","hh2TeV_hhB_deltaTheta","hh2TeV_hhB_deltaPhi2","hh2TeV_hhB_deltaTheta2"};
                  
                                    // std::vector<std::string> vars = {"hwwB_deltaPhi","hwwB_deltaTheta","hwwB_deltaPhi2","hwwB_deltaTheta2","hh2TeV_hwwB_deltaPhi","hh2TeV_hwwB_deltaTheta","hh2TeV_hwwB_deltaPhi2","hh2TeV_hwwB_deltaTheta2"};
                                                      // std::vector<std::string> vars = {"wlnuB_deltaPhi","wlnuB_deltaTheta","wlnuB_deltaPhi2","wlnuB_deltaTheta2","hh2TeV_wlnuB_deltaPhi","hh2TeV_wlnuB_deltaTheta","hh2TeV_wlnuB_deltaPhi2","hh2TeV_wlnuB_deltaTheta2"};
      
      std::vector<std::string> samps = {"m1000","m2000","ttbar","qcd"};
      
      for(unsigned int iV = 0; iV < vars.size(); ++iV){
          Plotter * p = new Plotter();
          for(unsigned int iS = 0; iS < samps.size(); ++iS){
            if(iV>3 && !iS) continue;
          TH1 * h = 0;
          f->GetObject((samps[iS]+"_"+vars[iV]).c_str(),h);
          if(h==0) continue;
          // h = PlotTools::getIntegral(h,true,true);
          p->addHistLine(h,samps[iS]);
                    
          }
          p->rebin(4);
          
          p->normalize();
          p->draw(false,vars[iV]);
      }
  
  
  }
  
  
  {
      TFile * f = new TFile("tryNewHiggsSolverAll.root","read");
      // std::vector<std::string> vars = {"orig_hh_mass","new_hh_mass","newLowChisq_hh_mass","orig_hom_hh_mass"};
      // std::vector<std::string> vars = {"orig_hh_mass","origLowMD_hh_mass","origLowMD_hom_hh_mass","new_hh_mass","newLowChisq_hh_mass","newLowChisq_hom_hh_mass"};
            // std::vector<std::string> vars = {"origLowMD_hom_hh_mass","newLowChisq_hh_mass","newLowChisq_hom_hh_mass"};
      // std::vector<std::string> vars = {"origLowMD_hom_hh_mass","newLowChisq_hh_mass","newLowChisq_hom_hh_mass"};
                  // std::vector<std::string> vars = {"jetSDMass","jetMass","jetDM","jetSJDM"};
      // std::vector<std::string> vars = {"orig_hom","new_hom","newLowChisq_hom"};
            std::vector<std::string> vars = {"hhB_deltaPhi","hhB_deltaTheta","hwwB_deltaPhi","hwwB_deltaTheta","wlnuB_deltaPhi","wlnuB_deltaTheta"};
      std::vector<std::string> samps = {"m1000","m2000","ttbar","qcd"};

          for(unsigned int iS = 0; iS < samps.size(); ++iS){
          Plotter * p = new Plotter();

      for(unsigned int iV = 0; iV < vars.size(); ++iV){
          TH1 * h = 0;
          f->GetObject((samps[iS]+"_"+vars[iV]).c_str(),h);
          if(h==0) continue;
          // h = PlotTools::getIntegral(h,true,true);
          p->addHistLine(h,samps[iS] +"_"+ vars[iV]);

          }
          p->rebin(4);
          // p->normalize();
          p->setBotMinMax(0.,2.);
          p->drawSplitRatio(0,"stack",false,false,samps[iS]);
      }


  }
  
  
  
  /////////////
  . /Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/predMacros/runInputs.sh . /Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/predMacros/
   rr '/Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/plotting/plotResBkgTests.C+   (6,true,0,"chisqT_hoe")'
   rr '/Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/plotting/plotSignalTests.C+   (4,0,true   ,"chisqT_hoe")'
   rr '/Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/plotting/plotSignalTests.C+   (0,0,true   ,"chisqT_hoe")'
   /Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/predMacros/makeCards.sh hhsTest_chisqT_hoe 0 0 1 /Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/predMacros/
     nohup combine -m 2500 -M AsymptoticLimits -v 2 --run expected --rMax 0.06   combinedCard.txt &
     nohup combine -m 1000 -M AsymptoticLimits -v 2 --run expected --rMax 0.2   combinedCard.txt &
       
       nohup combine -m 800 -M AsymptoticLimits -v 2 --run expected --rMax 0.5   combinedCard.txt &
       
  rr -b -q '/Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/plotting/plotHHSTest.C+   (0,2,"trees/betrees_mc.root","mc")' &
  rr -b -q '/Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/plotting/plotHHSTest.C+   (0,2,"trees/out_radion_hh_bbinc_m1000_0.root","m1000")' &
  rr -b -q '/Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/plotting/plotHHSTest.C+   (0,2,"trees/out_radion_hh_bbinc_m2500_0.root","m2500")' &
  rr       '/Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/plotting/plotHHSTest.C+         (1,0,"","")' 
  rr       '/Users/nmccoll/Dropbox/Work/GitRepositories/TreeAnalyzer/background_estimation/plotting/plotHHSTest.C+         (2,0,"","")' 
       
       
       
  {
      TFile * f = new TFile("HHlnujj_mc_hhsTests.root");
      TFile * s1 = new TFile("HHlnujj_m1000_hhsTests.root");
      TFile * s2 = new TFile("HHlnujj_m2500_hhsTests.root");

      std::vector<std::string> vars = {"hhMass","hhSMass","hwwPT_o_hhMass","wwDM","chisq"};
      std::vector<std::string> sels = {"hhMass","hhSMass","hhMass_md","hhMass_md_hoe","hhSMass_chisq","hhSMass_chisq_hoe"};
      std::vector<std::string> samps = {"ttbar","wjets","qcd","other"};
      
      
          for(unsigned int iS = 0; iS < sels.size(); ++iS){
          
      for(unsigned int iV = 0; iV < vars.size(); ++iV){
        Plotter * p = new Plotter();

        for(unsigned int iB= 0; iB < samps.size(); ++iB){        
          TH1 * h = 0;
          f->GetObject((samps[iB]+"_"+sels[iS]+"_"+vars[iV]).c_str(),h);
          if(h==0) continue;
          // h = PlotTools::getIntegral(h,true,true);
          p->addStackHist(h,samps[iB]);
          }
          TH1 * hs1 = 0;
          s1->GetObject(("all_"+sels[iS]+"_"+vars[iV]).c_str(),hs1);
          if(hs1){
            hs1->SetName((std::string("m1000_")+sels[iS]+"_"+vars[iV]).c_str());
          }          p->addHistLine(hs1,"m1000");
          TH1 * hs2 = 0;
          s2->GetObject(("all_"+sels[iS]+"_"+vars[iV]).c_str(),hs2);
          if(hs2){
            hs2->SetName((std::string("m2500_")+sels[iS]+"_"+vars[iV]).c_str());
          }          p->addHistLine(hs2,"m2500");
          // h = PlotTools::getIntegral(h,true,true);

          
          // p->rebin(10);
          // p->normalize();
          p->draw(false,sels[iS]+"_"+vars[iV]);
      }


  }
}
  
  
  
{
  TFile * f = new TFile("HHlnujj_mc_hhsTests.root");
  TFile * s1 = new TFile("HHlnujj_m1000_hhsTests.root");
  TFile * s2 = new TFile("HHlnujj_m2500_hhsTests.root");
;
    std::vector<std::string> vars = {"hhSMass_chisq","hhMass_wwDM",};
    // std::vector<std::string> samps = {"ttbar","wjets","qcd"};
        std::vector<std::string> samps = {"ttbar","wjets"};

    for(unsigned int iV = 0; iV < vars.size(); ++iV){
        Plotter * p = new Plotter();
        for(unsigned int iS = 0; iS < samps.size(); ++iS){
        TH1 * h = 0;
        f->GetObject((samps[iS]+"_"+vars[iV]).c_str(),h);
        if(h==0) continue;
        // h = PlotTools::getIntegral(h,true,true);
        p->addHistLine(h,samps[iS]);
        }
        TH1 * hs1 = 0;
        s1->GetObject(("all_"+vars[iV]).c_str(),hs1);
        if(hs1){
          hs1->SetName((std::string("m1000_")+vars[iV]).c_str());
          // hs1 = PlotTools::getIntegral(hs1,true,true);
          p->addHistLine(hs1,"#it{m}_{X} 1 TeV");


        }


        TH1 * hs2 = 0;
        s2->GetObject(("all_"+vars[iV]).c_str(),hs2);
        if(hs2){
          hs2->SetName((std::string("m2500_")+vars[iV]).c_str());
          // hs2 = PlotTools::getIntegral(hs2,true,true);
                    p->addHistLine(hs2,"#it{m}_{X} 2.5 TeV");
        }
        p->rebin(2);

        p->normalize();
        p->draw(false,vars[iV]);
    }


}


{
  TFile * f = new TFile("HHlnujj_mc_hhsTests.root");
  TFile * s1 = new TFile("HHlnujj_m1000_hhsTests.root");
  TFile * s2 = new TFile("HHlnujj_m2500_hhsTests.root");

    // std::vector<std::string> vars = {"hhMass_hhMass","hhMass_md_hhMass","hhSMass_hhSMass","hhSMass_chisq_hhSMass"};
    // std::vector<std::string> vars = {"hhMass_md_hhMass","hhMass_md_hoe_hhMass","hhSMass_chisq_hhSMass","hhSMass_chisqT_hhSMass"};
    // std::vector<std::string> vars = {"hhMass_md_hhMass","hhSMass_chisq_hoe_hhSMass","hhSMass_chisq_hhSMass","hhSMass_chisqT_hhSMass"};
      // std::vector<std::string> vars = {"hhMass_md_hoe_hhMass","hhSMass_chisq_hoe_hhSMass","hhSMass_chisqT_hhSMass","hhSMass_chisqT_hoe_hhSMass"};
            // std::vector<std::string> vars = {"hhMass_md_hhMass","hhSMass_chisq_hhSMass","hhSMass_chisqT_hhSMass","hhSMass_md_hhSMass"};
                                                  std::vector<std::string> vars = {"hhMass_hhMass","hhMass_md_hhMass","hhSMass_hhSMass","hhSMass_chisq_hhSMass"};
                        // std::vector<std::string> vars = {"hhMass_hhMass","hhSMass_hhSMass"};
                        std::vector<std::string> varNs = {"old method","new method"};


    std::vector<std::string> samps = {"ttbar","wjets","qcd"};
        // std::vector<std::string> samps = {"all"};



    auto doSamp = [&](TFile *f, std::string name, std::string hname){

      Plotter * p = new Plotter();

      for(unsigned int iV = 0; iV < vars.size(); ++iV){
      TH1 * h = 0;
      f->GetObject((hname+"_"+vars[iV]).c_str(),h);
      if(h==0) continue;
      h->SetName((name+"_"+vars[iV]).c_str());
      // h = PlotTools::getIntegral(h,true,true);
      p->addHistLine(h,name +"_"+ vars[iV]);
      // p->addHistLine(h,varNs[iV]);
      }
      p->rebin(5);
      p->setBotMinMax(0.,2.);
      p->drawSplitRatio(0,"stack",false,false,name);
    };
    
    
      for(unsigned int iS = 0; iS < samps.size(); ++iS){
        doSamp(f,samps[iS],samps[iS]);
      }
      
      doSamp(s1,"m1000","all");
      doSamp(s2,"m2500","all");



}

cp

hhsTest_chisq_hoe_rad
hhsTest_chisqT_hoe_rad
hhsTest_chisq_rad
hhsTest_std_rad



cp hhsTest_chisq_hoe_rad/higgsCombineTest.AsymptoticLimits.mH800.root  HiggsCombineTest_chisq_hoe.AsymptoticLimits.mH800.root
cp hhsTest_chisq_hoe_rad/higgsCombineTest.AsymptoticLimits.mH2500.root HiggsCombineTest_chisq_hoe.AsymptoticLimits.mH2500.root
cp hhsTest_chisq_hoe_rad/higgsCombineTest.AsymptoticLimits.mH1000.root HiggsCombineTest_chisq_hoe.AsymptoticLimits.mH1000.root
  cp hhsTest_chisqT_hoe_rad/higgsCombineTest.AsymptoticLimits.mH800.root  HiggsCombineTest_chisqT_hoe.AsymptoticLimits.mH800.root
  cp hhsTest_chisqT_hoe_rad/higgsCombineTest.AsymptoticLimits.mH2500.root HiggsCombineTest_chisqT_hoe.AsymptoticLimits.mH2500.root
  cp hhsTest_chisqT_hoe_rad/higgsCombineTest.AsymptoticLimits.mH1000.root HiggsCombineTest_chisqT_hoe.AsymptoticLimits.mH1000.root
    cp hhsTest_chisq_rad/higgsCombineTest.AsymptoticLimits.mH800.root  HiggsCombineTest_chisq.AsymptoticLimits.mH800.root
    cp hhsTest_chisq_rad/higgsCombineTest.AsymptoticLimits.mH2500.root HiggsCombineTest_chisq.AsymptoticLimits.mH2500.root
    cp hhsTest_chisq_rad/higgsCombineTest.AsymptoticLimits.mH1000.root HiggsCombineTest_chisq.AsymptoticLimits.mH1000.root
      cp hhsTest_std_rad/higgsCombineTest.AsymptoticLimits.mH800.root  HiggsCombineTest_std.AsymptoticLimits.mH800.root
      cp hhsTest_std_rad/higgsCombineTest.AsymptoticLimits.mH2500.root HiggsCombineTest_std.AsymptoticLimits.mH2500.root
      cp hhsTest_std_rad/higgsCombineTest.AsymptoticLimits.mH1000.root HiggsCombineTest_std.AsymptoticLimits.mH1000.root
        
        
        
{

  
std::vector<std::string> masses ={"mH800","mH1000","mH2500"};
std::vector<std::string> sels ={"std","chisq","chisq_hoe","chisqT_hoe"};
  
  
  
  
  
    std::vector<std::vector<float> > vals(sels.size(),std::vector<float>(masses.size()));
    
    for(unsigned int iS= 0; iS < sels.size();++iS){
    for(unsigned int iM = 0; iM < masses.size();++iM){
    TFile * f = new TFile((std::string("HiggsCombineTest_")+sels[iS]+".AsymptoticLimits."+masses[iM]+".root").c_str(),"read");
    TTree * t = 0;
    f->GetObject("limit",t);

    double limit;
    float quantileExpected;
    double mh;
    t->SetBranchAddress("limit",&limit);
    t->SetBranchAddress("quantileExpected",&quantileExpected);
    t->SetBranchAddress("mh",&mh);
    int eventNumber = 0;
    float val;
    while(t->GetEntry(eventNumber)){
        if(quantileExpected==0.5) val = limit;
        ++eventNumber;
    }
    vals[iS][iM] =val;
    f->Close();
    }
  }
    
  for(unsigned int iS= 0; iS < sels.size();++iS){
    std::cout << sels[iS];
  for(unsigned int iM = 0; iM < masses.size();++iM){
        
    std::cout <<  "\t"<<vals[iS][iM];
    
    }
    std::cout << std::endl;
  }
 std::cout << std::endl;

}
